# Listen on the standard port
listen: 0.0.0.0:4222

# Use auth with environment variables
authorization {
  users = [
    { user: $NATS_USERNAME, password: $NATS_PASSWORD }
  ]
}

# TLS configuration
#tls {
#  cert_file: $NATS_TLS_CERT
#  key_file:  $NATS_TLS_KEY
#  ca_file:   $NATS_TLS_CA
#  # This enables client certs
#  #verify:    true
#}

# JetStream configuration
jetstream {
  store_dir: /tmp/nats-data
}

# Stream definitions (at top level, not inside jetstream)
streams {
  test-stream {
    subjects: ["test.>"]
    storage: memory
    max_age: 1h

    # Define consumers for this stream
    consumers {
      test-consumer {
        durable_name: test-consumer
        filter_subject: "test.>"
        deliver_policy: all
        ack_policy: explicit
        ack_wait: 30s
        max_deliver: 5
      }
    }
  }
}